We extend the Firedrake framework with an automated goal-based adaptive meshing solver for PDEs and eigenproblems. For PDEs, the user provides the UFL form, a target functional J(u), and a tolerance; the solver estimates the goal error |J(u)-J(u_h)| and refines cells in the mesh that contribute most to this error, iterating until the tolerance is met. For eigenproblems, the user provides a target eigenvalue, and the solver minimises the error in the closest eigenvalue, |λ-λ_h|.

A major barrier to adoption of goal-based adaptivity has been the requirement for error estimators to be manually derived for each PDE problem. Our solver removes the need for manual derivations by automatically computing local error estimators, extending an approach originally developed by Rognes and Logg. The key differences are that we formulate the automated algorithm in UFL as local DG0 problems and extend the algorithm to eigenvalue problems. In doing so, we increase the accessibiity of goal-based adaptivity to those without specialist expertise in the dual-weighted-residual method, the theory upon which goal-based adaptivity lies.

For PDEs, we have demonstrated efficiency on standard benchmark problems, including mixed formulations such as weakly symmetric linear elasticity. For eigenproblems, strong results have been obtained for Maxwell and Stokes problems.
